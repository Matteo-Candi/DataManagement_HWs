//1. Find how many medals Italy won IN each discipline 
MATCH(c:Country)-[:NATIONALITY]-(a:Athlete)-[tot:WIN_MEDAL_IN]-(h:Host)
WHERE c.name='Italy'
RETURN COUNT(tot) AS italian_medals, tot.discipline
ORDER BY italian_medals DESC;


//2. Find the top 10 athletes that win more medals IN a single Olympic game
MATCH(a:Athlete)-[med:WIN_MEDAL_IN]-(h:Host) 
RETURN a.name as athlete, a.url as url, count(med) as num_medals, h.name as game 
ORDER BY num_medals DESC LIMIT 10;


// 3. Find top 5 Olympic games in which local athletes win more medals
MATCH(c1:Country)<-[:NATIONALITY]-(a:Athlete)-[tot:WIN_MEDAL_IN]->(h:Host)-[:TAKE_PLACE_IN]->(c2:Country)
WHERE c1 = c2
RETURN COUNT(*) AS local_medals, h.name AS host, c1.name AS country
ORDER BY local_medals DESC LIMIT 5;

// 4. Find the Italian athletes with the most medals
MATCH (h:Host) <-[med:WIN_MEDAL_IN] - (a:Athlete)-[:NATIONALITY] -> (c:Country{name:'Italy'})
RETURN a.name as athlete, a.url as url, count(med) as num_medals
ORDER BY num_medals DESC;

// 6. Find respectively the non-team AND team sports that have more medals
MATCH (h:Host) - [med:WIN_MEDAL_IN {partecipant_type:'GameTeam'}] - (a:Athlete) - [team:IN_TEAM_WITH] - (a1:Athlete)
RETURN count(*) as medals, med.discipline as discipline
ORDER BY medals DESC LIMIT 1
UNION
MATCH (h1:Host) - [med1:WIN_MEDAL_IN {partecipant_type:'Athlete'}] - (a2:Athlete) 
RETURN count(*) as medals,  med1.discipline as discipline
ORDER BY medals DESC LIMIT 1